#!/usr/bin/env ruby
# frozen_string_literal: true

require "fileutils"

include FileUtils # rubocop:disable Style/MixinUsage

framework = ARGV.first

unless framework
  puts "Specify a framework to generate fake tests (guava/minitest/parallel)"
  return
end

FileUtils.rm(Dir["test/fake/#{framework}/**/*.rb"])

parent_class = case framework
               when "guava"
                 "Guava::Test"
               when "minitest"
                 "Minitest::Test"
               else
                 "ActiveSupport::TestCase"
               end

(0...100).map do |i|
  File.open("#{__dir__}/../test/fake/#{framework}/fake_#{i}_test.rb", "w") do |f|
    f.write(<<~CONTENT)
      # frozen_string_literal: true

      require_relative "../#{framework}_test_helper"

      class #{framework.capitalize}Fake#{i}Test < #{parent_class}
        def setup
          @number = #{i}
        end

        def test_quick
          assert(true)
        end

        def test_failing_test
          refute_equal 0, #{i} % 20
        end

        def test_sleepy
          sleep 0.2
          assert(true)
        end
      end
    CONTENT
  end
end
